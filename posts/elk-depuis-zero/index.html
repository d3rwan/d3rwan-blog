<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/d3rwan-blog/styles.1685a65f5c5eaed5bc13.css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.625;font-size:1rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:2.5rem;line-height:3.25rem;margin-top:6.5rem;margin-bottom:1.625rem}h2{font-size:1.6875rem;line-height:2.4375rem}h2,h3{margin-top:3.25rem;margin-bottom:.8125rem}h3{font-size:1.375rem;line-height:1.625rem}h4{font-size:1.2rem;margin-top:2.4375rem}h4,h5{line-height:1.625rem;margin-bottom:.8125rem}h5,h6{font-size:1rem;margin-top:4.0625rem}h6{line-height:1.625rem;margin-bottom:.8125rem}img{border:0;max-width:100%;margin:inherit auto}img,img+em{display:block}img+em{text-align:center;margin-top:.2rem;font-style:italic;font-weight:600;font-size:.875rem}hr{border:0;color:#222;display:block;height:1.625rem;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#5d93ff;text-decoration:none}a:active,a:focus,a:hover{color:#f7a046}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.625rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.625rem;margin-bottom:1.625rem}blockquote{padding:0;font-style:italic;text-align:center}figure{display:block;width:100%;height:auto}figcaption{line-height:1.21875rem;margin-top:.40625rem;color:#222;font-size:.875rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.625rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#073642}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:1.125rem;font-weight:600;line-height:1.82813rem;margin:.8125rem 0}.Author-module--author__title-link--Yrism,.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#222}.Author-module--author__subtitle--cAaEB{color:#888;line-height:1.625rem;margin-bottom:1.625rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.625rem}.Contacts-module--contacts__list--3OgdW{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:2.1875rem;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#5d93ff}.Copyright-module--copyright--1ariN{color:#b6b6b6;font-size:.875rem}.Menu-module--menu--Efbin{margin-bottom:1.625rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:1rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Menu-module--menu__list-item-link--active--2CbUO{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#e6e6e6;background:-webkit-gradient(linear,left top,left bottom,from(#e6e6e6),color-stop(48%,#e6e6e6),to(#fff));background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:33.75rem;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Feed-module--feed__item--2D5rE{margin-bottom:2.03125rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.8125rem}.Feed-module--feed__item-title--3nigr{font-size:1.6875rem;line-height:2.4375rem;margin-top:0;margin-bottom:.8125rem}.Feed-module--feed__item-title-link--iFMRs{color:#222}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--1uO8e{font-size:1rem;line-height:1.625rem;margin-bottom:1.21875rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.875rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-reading--2RlxZ{color:#5e5e5e;font-weight:200;font-size:small;float:right}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.875rem;color:#f7a046;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#5d93ff}.Feed-module--feed__item-readmore--1u6bI{font-size:1rem;color:#5d93ff}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Page-module--page--2nMky{margin-bottom:3.25rem}.Page-module--page__inner--2M_vz{padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:2.5rem;font-weight:600;line-height:3.25rem;margin-top:0;margin-bottom:2.35625rem}.Page-module--page__body--Ic6i6{font-size:1rem;line-height:1.625rem;margin:0 0 1.625rem}.Page-module--page--2nMky .Page-module--back-button--2qnR3{display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:1rem;font-weight:400;margin-bottom:1.625rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--2H3nO{margin-top:3.25rem;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#5d93ff}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#5d93ff}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#bbb}.Author-module--author--2Yefr{border-top:1px solid #e6e6e6;max-width:40rem;padding-top:1.25rem;line-height:1.625rem;margin-top:1.625rem;margin-bottom:3.25rem}.Author-module--author__bio-twitter--n-O9n{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2Yefr{margin-left:auto;margin-right:auto}}.Content-module--content--3p512{max-width:59.0625rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:2rem;max-width:40rem;font-weight:600;text-align:center;line-height:2.68125rem;margin:1.625rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.625rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.625rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:40rem;font-size:1.6817rem;margin-top:0;margin-bottom:1.625rem;line-height:2.4375rem}.Content-module--content__body--2TrQ- a{text-decoration:underline}.Content-module--content__body--2TrQ- *{max-width:40rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:3rem;line-height:3.65625rem;margin-top:3.65625rem;margin-bottom:2.4375rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:1.125rem;line-height:1.82813rem;margin-bottom:1.82813rem}}.Meta-module--meta__date--29eD7{font-style:italic;text-align:right}.Tags-module--tags--1L_ct{margin-bottom:.8125rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#5d93ff}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:40rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--16Kl0{display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:1rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.625rem}.Post-module--post__home-button--16Kl0:focus,.Post-module--post__home-button--16Kl0:hover{color:#5d93ff}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__home-button--16Kl0{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.20.12"/><link rel="alternate" type="application/rss+xml" title="Blog - Erwan Deruelle" href="/d3rwan-blog/rss.xml"/><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id="></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', '', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/d3rwan-blog/sitemap.xml"/><link rel="icon" href="/d3rwan-blog/icons/icon-48x48.png?v=5a95576050eb0ca6c486e2048b8195a5"/><link rel="manifest" href="/d3rwan-blog/manifest.webmanifest"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/d3rwan-blog/icons/icon-48x48.png?v=5a95576050eb0ca6c486e2048b8195a5"/><link rel="apple-touch-icon" sizes="72x72" href="/d3rwan-blog/icons/icon-72x72.png?v=5a95576050eb0ca6c486e2048b8195a5"/><link rel="apple-touch-icon" sizes="96x96" href="/d3rwan-blog/icons/icon-96x96.png?v=5a95576050eb0ca6c486e2048b8195a5"/><link rel="apple-touch-icon" sizes="144x144" href="/d3rwan-blog/icons/icon-144x144.png?v=5a95576050eb0ca6c486e2048b8195a5"/><link rel="apple-touch-icon" sizes="192x192" href="/d3rwan-blog/icons/icon-192x192.png?v=5a95576050eb0ca6c486e2048b8195a5"/><link rel="apple-touch-icon" sizes="256x256" href="/d3rwan-blog/icons/icon-256x256.png?v=5a95576050eb0ca6c486e2048b8195a5"/><link rel="apple-touch-icon" sizes="384x384" href="/d3rwan-blog/icons/icon-384x384.png?v=5a95576050eb0ca6c486e2048b8195a5"/><link rel="apple-touch-icon" sizes="512x512" href="/d3rwan-blog/icons/icon-512x512.png?v=5a95576050eb0ca6c486e2048b8195a5"/><title data-react-helmet="true">Une stack ELK from scratch avec Docker - Blog - Erwan Deruelle</title><meta data-react-helmet="true" name="description" content="Ou comment déployer une architecture de monitoring en quelques minutes"/><meta data-react-helmet="true" property="og:site_name" content="Une stack ELK from scratch avec Docker - Blog - Erwan Deruelle"/><meta data-react-helmet="true" property="og:image" content="https://d3rwan.github.io/d3rwan-blog/d3rwan-blog/media/elk/response.png"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Une stack ELK from scratch avec Docker - Blog - Erwan Deruelle"/><meta data-react-helmet="true" name="twitter:description" content="Ou comment déployer une architecture de monitoring en quelques minutes"/><meta data-react-helmet="true" name="twitter:image" content="https://d3rwan.github.io/d3rwan-blog/d3rwan-blog/media/elk/response.png"/><link as="script" rel="preload" href="/d3rwan-blog/webpack-runtime-833c02dd0c62823c7b54.js"/><link as="script" rel="preload" href="/d3rwan-blog/framework-88c48abae272a3bc68e7.js"/><link as="script" rel="preload" href="/d3rwan-blog/app-6a7feee794e305ff970e.js"/><link as="script" rel="preload" href="/d3rwan-blog/styles-083a06cb5740baaf347d.js"/><link as="script" rel="preload" href="/d3rwan-blog/02829756d7c9841fdd33d32bcc7843fcf4b76a8f-0bf89863b643af7e9cd0.js"/><link as="script" rel="preload" href="/d3rwan-blog/06a1f2c941cd55aef4842384529632245d8720e1-87f6c214daddf9a7b43d.js"/><link as="script" rel="preload" href="/d3rwan-blog/component---src-templates-post-template-js-6279ae0603857b831b13.js"/><link as="fetch" rel="preload" href="/d3rwan-blog/page-data/posts/elk-depuis-zero/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/d3rwan-blog/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><div><a class="Post-module--post__home-button--16Kl0" href="/d3rwan-blog/">&lt; Home</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">Une stack ELK from scratch avec Docker</h1><div class="Content-module--content__body--2TrQ-"><p>Ou comment déployer une architecture de monitoring en quelques minutes.</p>
<h2 id="mo-ni-to-rer" style="position:relative;"><a href="#mo-ni-to-rer" aria-label="mo ni to rer permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong><em>Mo-ni-to-rer.</em></strong></h2>
<p>En quelques années, le monitoring est devenu une activité indispensable dans le monde de l’IT. Qu’il soit technique ou fonctionnel, qu’il fournisse des métriques, charts, ou autres KPI, le monitoring de son système est devenu un must-have.</p>
<p>Dans la suite de l’article, nous allons voir comment déployer une architecture de monitoring à partir de zéro, en quelques minutes, grâce à Docker.</p>
<h2 id="la-stack" style="position:relative;"><a href="#la-stack" aria-label="la stack permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>La stack.</h2>
<p>Pour commencer, nous nous appuyerons sur la stack <strong><em>ELK</em></strong> qui, en quelques années, est devenue une alternative crédible aux autres solutions de monitoring (Splunk, solutions SAAS…).</p>
<p>Elle se compose des éléments suivants:</p>
<ul>
<li><strong>E</strong> comme <em>Elasticsearch</em>, le moteur d’indexation, de recherche &#x26; d’analytics,</li>
<li><strong>L</strong> comme <em>Logstash</em>, un ETL permettant de récupérer les données dans des sources hétérogènes, les transformer et les envoyer vers Elasticsearch,</li>
<li><strong>K</strong> comme <em>Kibana</em>, un IHM de visualisation et de générations de tableaux de bord interactifs</li>
</ul>
<p>Nous ajouterons également :</p>
<ul>
<li><strong>R</strong> comme *Redis, *utilisé comme broker en amont, qui servira de buffer en cas de latence du système, tout en évitant un engorgement trop important en cas de pic,</li>
<li><strong>C</strong> comme <em>Curator</em>, un outil de management des indexs</li>
<li>**B *<em>comme *Beats</em>, sondes à installer côté client afin d’envoyer les logs/métriques à notre stack</li>
</ul>
<p><img src="/d3rwan-blog/media/elk/stack-elk.jpeg" alt="Stack de monitoring"><em>Notre stack de monitoring</em></p>
<h2 id="déploiement" style="position:relative;"><a href="#d%C3%A9ploiement" aria-label="déploiement permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong><em>Déploiement.</em></strong></h2>
<p>Nous utiliserons des conteneurs Docker pour chacun des composants de notre stack.</p>
<ul>
<li><a href="https://hub.docker.com/_/elasticsearch/" target="_blank" rel="nofollow noopener noreferrer">Elasticsearch</a>, dans sa version 5.1.2,</li>
<li><a href="https://hub.docker.com/_/logstash/" target="_blank" rel="nofollow noopener noreferrer">Logstash</a>, dans sa version 5.1.2,</li>
<li><a href="https://hub.docker.com/_/kibana/" target="_blank" rel="nofollow noopener noreferrer">Kibana</a>, dans sa version 5.1.2,</li>
<li><a href="https://hub.docker.com/_/redis/" target="_blank" rel="nofollow noopener noreferrer">Redis</a>, dans sa version 3.2.6,</li>
<li><a href="https://hub.docker.com/r/bobrik/curator/" target="_blank" rel="nofollow noopener noreferrer">Curator</a>, dans sa version 4.0.4</li>
</ul>
<p>L’ensemble des services et des interactions sont décrites dans un fichier docker-compose.yml:</p>
<p><div id="gist40308415" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-docker-compose-yml" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-yaml ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip>
      <tr>
        <td id="file-docker-compose-yml-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-docker-compose-yml-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">version</span>: <span class="pl-s"><span class="pl-pds">&quot;</span>2<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-docker-compose-yml-LC2" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-docker-compose-yml-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">services</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-docker-compose-yml-LC4" class="blob-code blob-code-inner js-file-line">  <span class="pl-c"><span class="pl-c">#</span> brocker</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-docker-compose-yml-LC5" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">redis</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-docker-compose-yml-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">image</span>: <span class="pl-s">redis:3.2.6</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-docker-compose-yml-LC7" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">container_name</span>: <span class="pl-s">redis</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-docker-compose-yml-LC8" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">ports</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-docker-compose-yml-LC9" class="blob-code blob-code-inner js-file-line">      - <span class="pl-c1">6379:6379</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-docker-compose-yml-LC10" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">volumes</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-docker-compose-yml-LC11" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">redis-data:/data</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-docker-compose-yml-LC12" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">networks</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-docker-compose-yml-LC13" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">logging</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-docker-compose-yml-LC14" class="blob-code blob-code-inner js-file-line">  <span class="pl-c"><span class="pl-c">#</span> index, search &amp; agregation</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-docker-compose-yml-LC15" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">elasticsearch</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-docker-compose-yml-LC16" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">image</span>: <span class="pl-s">elasticsearch:5.1.2</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-docker-compose-yml-LC17" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">container_name</span>: <span class="pl-s">elastic</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-docker-compose-yml-LC18" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">environment</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-docker-compose-yml-LC19" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">ES_JAVA_OPTS=-Xms1g -Xmx1g</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-docker-compose-yml-LC20" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">ports</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-docker-compose-yml-LC21" class="blob-code blob-code-inner js-file-line">      - <span class="pl-c1">9200:9200</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-docker-compose-yml-LC22" class="blob-code blob-code-inner js-file-line">      - <span class="pl-c1">9300:9300</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-docker-compose-yml-LC23" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">volumes</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-docker-compose-yml-LC24" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">$PWD/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-docker-compose-yml-LC25" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s"><span class="pl-pds">&quot;</span>es-data:/usr/share/elasticsearch/data<span class="pl-pds">&quot;</span></span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-docker-compose-yml-LC26" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">networks</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-docker-compose-yml-LC27" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">logging</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-docker-compose-yml-LC28" class="blob-code blob-code-inner js-file-line">  <span class="pl-c"><span class="pl-c">#</span> UI</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-docker-compose-yml-LC29" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">kibana</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-docker-compose-yml-LC30" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">image</span>: <span class="pl-s">kibana:5.1.2</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-docker-compose-yml-LC31" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">container_name</span>: <span class="pl-s">kibana</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-docker-compose-yml-LC32" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">ports</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-docker-compose-yml-LC33" class="blob-code blob-code-inner js-file-line">      - <span class="pl-c1">5601:5601</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-docker-compose-yml-LC34" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">volumes</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-docker-compose-yml-LC35" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">$PWD/kibana/config/kibana.yml:/etc/kibana/kibana.yml</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-docker-compose-yml-LC36" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">networks</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-docker-compose-yml-LC37" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">logging</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-docker-compose-yml-LC38" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">depends_on</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-docker-compose-yml-LC39" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">elasticsearch</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-docker-compose-yml-LC40" class="blob-code blob-code-inner js-file-line">  <span class="pl-c"><span class="pl-c">#</span> indexer</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-docker-compose-yml-LC41" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">logstash</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-docker-compose-yml-LC42" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">image</span>: <span class="pl-s">logstash:5.1.2</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-docker-compose-yml-LC43" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">container_name</span>: <span class="pl-s">logstash</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-docker-compose-yml-LC44" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">command</span>: <span class="pl-s">logstash -f /config/</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-docker-compose-yml-LC45" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">environment</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L46" class="blob-num js-line-number" data-line-number="46"></td>
        <td id="file-docker-compose-yml-LC46" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">JAVA_OPTS=-Xms1g -Xmx1g</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L47" class="blob-num js-line-number" data-line-number="47"></td>
        <td id="file-docker-compose-yml-LC47" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">volumes</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L48" class="blob-num js-line-number" data-line-number="48"></td>
        <td id="file-docker-compose-yml-LC48" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">$PWD/logstash/config:/config</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L49" class="blob-num js-line-number" data-line-number="49"></td>
        <td id="file-docker-compose-yml-LC49" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">networks</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L50" class="blob-num js-line-number" data-line-number="50"></td>
        <td id="file-docker-compose-yml-LC50" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">logging</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L51" class="blob-num js-line-number" data-line-number="51"></td>
        <td id="file-docker-compose-yml-LC51" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">depends_on</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L52" class="blob-num js-line-number" data-line-number="52"></td>
        <td id="file-docker-compose-yml-LC52" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">elasticsearch</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L53" class="blob-num js-line-number" data-line-number="53"></td>
        <td id="file-docker-compose-yml-LC53" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s">redis</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L54" class="blob-num js-line-number" data-line-number="54"></td>
        <td id="file-docker-compose-yml-LC54" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L55" class="blob-num js-line-number" data-line-number="55"></td>
        <td id="file-docker-compose-yml-LC55" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">volumes</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L56" class="blob-num js-line-number" data-line-number="56"></td>
        <td id="file-docker-compose-yml-LC56" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">es-data</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L57" class="blob-num js-line-number" data-line-number="57"></td>
        <td id="file-docker-compose-yml-LC57" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">driver</span>: <span class="pl-s">local</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L58" class="blob-num js-line-number" data-line-number="58"></td>
        <td id="file-docker-compose-yml-LC58" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">redis-data</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L59" class="blob-num js-line-number" data-line-number="59"></td>
        <td id="file-docker-compose-yml-LC59" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">driver</span>: <span class="pl-s">local</span></td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L60" class="blob-num js-line-number" data-line-number="60"></td>
        <td id="file-docker-compose-yml-LC60" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L61" class="blob-num js-line-number" data-line-number="61"></td>
        <td id="file-docker-compose-yml-LC61" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">networks</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L62" class="blob-num js-line-number" data-line-number="62"></td>
        <td id="file-docker-compose-yml-LC62" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">logging</span>:</td>
      </tr>
      <tr>
        <td id="file-docker-compose-yml-L63" class="blob-num js-line-number" data-line-number="63"></td>
        <td id="file-docker-compose-yml-LC63" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">driver</span>: <span class="pl-s">bridge</span></td>
      </tr>
</table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/d3rwan/66311cf71c8398aae0be32e47f270bab/raw/82a27cb75de0e72f2f67e1a2d72a94d7b7317678/docker-compose.yml" style="float:right">view raw</a>
        <a href="https://gist.github.com/d3rwan/66311cf71c8398aae0be32e47f270bab#file-docker-compose-yml">docker-compose.yml</a>
        hosted with &#10084; by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div></p>
<p>Pour chacun des services, on va définir si besoin les ports à exposer ou les volumes à utiliser (notamment les fichiers de configuration). Un exemple de configuration viable est disponible sur mon compte github : <a href="https://github.com/d3rwan/docker_elk_stack" target="_blank" rel="nofollow noopener noreferrer">docker_elk_stack</a>.</p>
<h2 id="hello-world" style="position:relative;"><a href="#hello-world" aria-label="hello world permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hello, world</h2>
<p>En se basant sur ce repository, nous allons déployer une stack fonctionnelle:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># clone repo &amp; build images
git clone [https://github.com/d3rwan/docker_elk_stack](https://github.com/d3rwan/docker_elk_stack)
cd docker_elk_stack
docker-compose build

# run (daemon)
docker-compose up -d

# show logs
docker-compose logs</code></pre></div>
<p>Une fois les différents composants démarrés, vous devriez pouvoir accéder à l’interface Kibana (port 5601).</p>
<p>Puis nous allons lancer un example d’application web (site HTML statique exposé par Nginx, ainsi qu’une sonde FileBeat permettant l’envoi des logs vers notre stack ELK)</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># build image
docker build ./webapp -t dockerelkstack_webapp

# run (daemon)
docker run --network dockerelkstack_logging --link redis:redis -p 80:80 -d --name webapp dockerelkstack_webapp

# show logs
docker logs webapp</code></pre></div>
<p>Une fois notre composant démarré, vous devriez pouvoir accéder à l’application web (port 80).</p>
<p><img src="/d3rwan-blog/media/elk/joliadmin.png" alt="Exemple d’application web"><em>Exemple d’application web (source: <a href="https://github.com/sbilly/joli-admin" target="_blank" rel="nofollow noopener noreferrer">https://github.com/sbilly/joli-admin</a>)</em></p>
<p>Après avoir navigué quelques minutes, en retournant sur l’IHM de Kibana, un index *logstash *est à présent disponible.</p>
<p><img src="/d3rwan-blog/media/elk/configure-pattern.png" alt="Configuration pattern d&#x27;index"><em>Kibana : écran de configuration d’un pattern d’index (ici, l’index logstash est détecté)</em></p>
<p>Après avoir crée notre pattern d’index, nous pouvons à présent naviguer dans les logs de notre application web (onglet <em>Discover</em>), créer des visualisations (onglet <em>Visualize</em>) et des tableaux de bord (onglet <em>Dashboard</em>)</p>
<p><img src="/d3rwan-blog/media/elk/response.png" alt="Kibana: données brutes"><em>Kibana: Visualisation brute des logs de notre application web</em></p>
<p><img src="/d3rwan-blog/media/elk/analytics.png" alt="Kibana: tableau de bord analytique"><em>Kibana: Tableau de bord analytique</em></p>
<p>And… voilà! Nous avons donc mis en place, en quelques minutes seulement, une stack de supervision opérationnelle.</p></div></div></div><div class="Post-module--post__footer--3WzWU"><div class="Tags-module--tags--1L_ct"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/d3rwan-blog/tag/monitoring/">Monitoring</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/d3rwan-blog/tag/elk/">ELK</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/d3rwan-blog/tag/elasticsearch/">Elasticsearch</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/d3rwan-blog/tag/kibana/">Kibana</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/d3rwan-blog/tag/logstash/">Logstash</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/d3rwan-blog/tag/redis/">Redis</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/d3rwan-blog/tag/docker/">Docker</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/d3rwan-blog/tag/architecture/">Architecture</a></li></ul></div><div><p class="Meta-module--meta__date--29eD7">Published on <!-- -->September 28, 2016</p></div></div><div class="Post-module--post__comments--25y6I"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/elk-depuis-zero";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-6a7feee794e305ff970e.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-0849e6483c9006ac9858.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-0d45aadac3c5082d3994.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-1ea3b17b8d0cae65adb3.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-37e05ac1e5e79e3b2541.js"],"component---src-templates-languages-list-template-js":["/component---src-templates-languages-list-template-js-382da22c5a5b59dda3ec.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-6279ae0603857b831b13.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-1b2e10dc7266e6298e9f.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-65e4ffa33a87c6dad430.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-c690e4afece3736bd449.js"],"component---src-templates-language-template-js":["/component---src-templates-language-template-js-ca215506ddf8420c3bcc.js"]};/*]]>*/</script><script src="/d3rwan-blog/component---src-templates-post-template-js-6279ae0603857b831b13.js" async=""></script><script src="/d3rwan-blog/06a1f2c941cd55aef4842384529632245d8720e1-87f6c214daddf9a7b43d.js" async=""></script><script src="/d3rwan-blog/02829756d7c9841fdd33d32bcc7843fcf4b76a8f-0bf89863b643af7e9cd0.js" async=""></script><script src="/d3rwan-blog/styles-083a06cb5740baaf347d.js" async=""></script><script src="/d3rwan-blog/app-6a7feee794e305ff970e.js" async=""></script><script src="/d3rwan-blog/framework-88c48abae272a3bc68e7.js" async=""></script><script src="/d3rwan-blog/webpack-runtime-833c02dd0c62823c7b54.js" async=""></script></body></html>
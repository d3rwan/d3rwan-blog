{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/kong","result":{"data":{"markdownRemark":{"id":"eca67b26-f5d5-5fe0-a303-4cf3af8e2d2f","html":"<p><a href=\"https://www.mashape.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Mashape</a> est un catalogue public d’API, permettant à ses utilisateurs de partager ses APIs ou d’utiliser celle des autres. Afin de sécuriser et gérer ces quelques 15000 micro-services présents dans leur catalogue, Mashape a crée <a href=\"https://getkong.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kong</a>, une solution d’API management.</p>\n<p>Kong est une solution open-source basée sur NGinx, qui permet de répondre aux contraintes des milliards de requêtes par mois que doit gérer Mashape.</p>\n<p><img src=\"/d3rwan-blog/media/kong/modules.png\"></p>\n<p>Kong s’appuie également sur une base de données Cassandra (possibilité d’utiliser PostgreSQL), ainsi que sur un ensemble de plug-ins. Par défaut, la solution offre déjà un socle de modules permettant l’authentification, la sécurité, le rate-limiting ou encore la supervision. Il vous sera également possible si besoin de créer vos propres plug-in (cf. <a href=\"https://getkong.org/plugins/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">la documentation officielle</a>) </p>\n<p>Dans votre infrastructure, l’API manager se place en amont des services à exposer (approche reverse-proxy), et prendra en charge les fonctionnalités que vous lui déléguez. Dès lors, chacun de vos services métiers n’aura plus à gérer ces taches techniques et pourra se concentrer sur son coeur métier.</p>\n<p><img src=\"/d3rwan-blog/media/kong/archi-wo-kong.png\"></p>\n<p><img src=\"/d3rwan-blog/media/kong/archi-w-kong.png\" alt=\"Architecture Legacy vs. Architecture orientée API\"><em>Architecture Legacy vs. Architecture orientée API</em></p>\n<p>Alors, que vous deviez gérer un ensemble de micro-services, une API qui commence à devenir populaire ou simplement un backend web/mobile, il est peut-être temps de commencer à gérer vos APIs.</p>\n<h2 id=\"getting-started\" style=\"position:relative;\"><a href=\"#getting-started\" aria-label=\"getting started permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Getting started</h2>\n<p>Dans cette partie, nous utiliserons comme API partenaire celle exposée par le site <a href=\"http://anapioficeandfire.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://anapioficeandfire.com/</a> et qui expose les données relatives à l’univers de Game of Thrones.</p>\n<p>Pour déployer Kong, nous utiliserons des conteneurs Docker <em>orchestrés</em> par docker-compose. La configuration de la stack est la suivante :</p>\n<p><div id=\"gist44731088\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-docker-compose-yml\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-yaml \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-docker-compose-yml-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-docker-compose-yml-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-ent\">version</span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>2<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-docker-compose-yml-LC2\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-docker-compose-yml-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-ent\">services</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-docker-compose-yml-LC4\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-ent\">cassandra</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-docker-compose-yml-LC5\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">image</span>: <span class=\"pl-s\">cassandra:2.2.8</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-docker-compose-yml-LC6\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">container_name</span>: <span class=\"pl-s\">cassandra</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-docker-compose-yml-LC7\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">ports</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-docker-compose-yml-LC8\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>9042:9042<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-docker-compose-yml-LC9\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-ent\">kong</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-docker-compose-yml-LC10\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">image</span>: <span class=\"pl-s\">kong</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-docker-compose-yml-LC11\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">container_name</span>: <span class=\"pl-s\">kong</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-docker-compose-yml-LC12\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">ports</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-docker-compose-yml-LC13\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>8000:8000<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-docker-compose-yml-LC14\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>8443:8443<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-docker-compose-yml-LC15\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>8001:8001<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-docker-compose-yml-LC16\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>7946:7946<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-docker-compose-yml-LC17\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>7946:7946/udp<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-docker-compose-yml-LC18\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">links</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-docker-compose-yml-LC19\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\">cassandra:cassandra</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-docker-compose-yml-LC20\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">environment</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-docker-compose-yml-LC21\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\">KONG_DATABASE=cassandra</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-docker-compose-yml-LC22\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\">KONG_CASSANDRA_CONTACT_POINTS=cassandra</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-docker-compose-yml-LC23\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">depends_on</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-docker-compose-yml-LC24\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\">cassandra</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-docker-compose-yml-LC25\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">restart</span>: <span class=\"pl-s\">always</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-docker-compose-yml-LC26\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">command</span>: <span class=\"pl-s\">[&quot;/bin/bash&quot;, &quot;-c&quot;, &quot; while ! nc cassandra 9042; do sleep 5; done &amp;&amp; kong start&quot;]</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-docker-compose-yml-LC27\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-ent\">ui</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-docker-compose-yml-LC28\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">image</span>: <span class=\"pl-s\">pgbi/kong-dashboard</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"></td>\n        <td id=\"file-docker-compose-yml-LC29\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">container_name</span>: <span class=\"pl-s\">ui</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"></td>\n        <td id=\"file-docker-compose-yml-LC30\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">ports</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L31\" class=\"blob-num js-line-number\" data-line-number=\"31\"></td>\n        <td id=\"file-docker-compose-yml-LC31\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>8080:8080<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L32\" class=\"blob-num js-line-number\" data-line-number=\"32\"></td>\n        <td id=\"file-docker-compose-yml-LC32\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">links</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L33\" class=\"blob-num js-line-number\" data-line-number=\"33\"></td>\n        <td id=\"file-docker-compose-yml-LC33\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\">kong:kong</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L34\" class=\"blob-num js-line-number\" data-line-number=\"34\"></td>\n        <td id=\"file-docker-compose-yml-LC34\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">depends_on</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-docker-compose-yml-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"></td>\n        <td id=\"file-docker-compose-yml-LC35\" class=\"blob-code blob-code-inner js-file-line\">      - <span class=\"pl-s\">kong</span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/d3rwan/011f9875f4cc3a11fd83860e0a9486f9/raw/2259ca238269289b7398acd51e714ec0eab450cc/docker-compose.yml\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/d3rwan/011f9875f4cc3a11fd83860e0a9486f9#file-docker-compose-yml\">docker-compose.yml</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<ul>\n<li>Démarrer la stack</li>\n</ul>\n<p>Depuis le répertoire contenant le fichier docker-compose.yml décrit précédemment</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    # run (daemon)\n    docker-compose up -d\n    # show logs\n    docker-compose logs -f</code></pre></div>\n<p>Une fois la stack démarrée, nous pouvons accéder à ses différents composants</p>\n<blockquote>\n<p>localhost si vous utilisez Docker sous Mac ou Linux, l’adresse de docker-machine sinon</p>\n</blockquote>\n<ul>\n<li>\n<p>API Manager - localhost**:8001</p>\n<ul>\n<li>API grâce à laquelle nous allons administrer Kong</li>\n</ul>\n</li>\n<li>\n<p>API Gateway - localhost**:8000</p>\n<ul>\n<li>API grâce à laquelle nous accéderons à nos API</li>\n</ul>\n</li>\n<li>\n<p>Kong Dashboard - localhost<strong>:8080</strong> </p>\n<ul>\n<li>IHM open-source qui utilise l’API d’administration afin d’offrir une interface d’administration</li>\n</ul>\n</li>\n</ul>\n<p>A présent, nous allons pouvoir utiliser notre API manager.</p>\n<blockquote>\n<p>Dans la suite de l’article, nous directement l’API via des appels REST, mais nous pourrions également utiliser l’IHM de Kong Dashboard pour configurer Kong</p>\n</blockquote>\n<h2 id=\"how-to\" style=\"position:relative;\"><a href=\"#how-to\" aria-label=\"how to permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to</h2>\n<h3 id=\"créer-une-api\" style=\"position:relative;\"><a href=\"#cr%C3%A9er-une-api\" aria-label=\"créer une api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Créer une API</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl -i -X POST http://localhost:8001/apis/ \\\n --data &#39;name=GOT&#39; \\\n --data &#39;upstream_url=http://anapioficeandfire.com/api/&#39; \\\n --data &#39;request_path=/got/&#39; \\\n --data &#39;preserve_host=false&#39;\\\n --data &#39;strip_request_path=true&#39;</code></pre></div>\n<p>On crée une API qu’on appelle <em>GOT</em> et qui pointe vers notre API partenaire, sur le path <em>/got/</em> de notre API gateway. On peut désormais y accéder via l’API gateway</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl -i -X GET http://localhost:8000/got/characters/583</code></pre></div>\n<h3 id=\"activer-lauthentification\" style=\"position:relative;\"><a href=\"#activer-lauthentification\" aria-label=\"activer lauthentification permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Activer l’authentification</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl -i -X POST http://localhost:8001/apis/GOT/plugins/ \\\n  --data &#39;name=key-auth&#39; \\\n  --data &#39;config.key_names=apiKey&#39;</code></pre></div>\n<p>On associe le plugin <a href=\"https://getkong.org/plugins/key-authentication/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">key-auth</a> de Kong à notre API qui ne sera donc plus accessible sans token d’authentification</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl -i -X GET http://localhost:8000/got/characters/583</code></pre></div>\n<h3 id=\"ajouter-un-utilisateur\" style=\"position:relative;\"><a href=\"#ajouter-un-utilisateur\" aria-label=\"ajouter un utilisateur permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ajouter un utilisateur</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl -i -X POST http://localhost:8001/consumers/ \\\n  --data &quot;username=erwan&quot;</code></pre></div>\n<h3 id=\"autoriser-ce-nouvel-utilisateur-à-accéder-à-lapi\" style=\"position:relative;\"><a href=\"#autoriser-ce-nouvel-utilisateur-%C3%A0-acc%C3%A9der-%C3%A0-lapi\" aria-label=\"autoriser ce nouvel utilisateur à accéder à lapi permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Autoriser ce nouvel utilisateur à accéder à l’API</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl -i -X POST http://localhost:8001/consumers/erwan/key-auth \\\n  --data &quot;key=secret&quot;</code></pre></div>\n<p>Notre API est donc bien sécurisée, et seulement accessible avec la clé d’authentification</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl -i -X GET [http://localhost:8000/got/characters/583](http://localhost:8000/got/characters/583)\ncurl -i -X GET [http://localhost:8000/got/characters/583](http://localhost:8000/got/characters/583)?apiKey=secret</code></pre></div>\n<h3 id=\"activer-le-rate-limiting\" style=\"position:relative;\"><a href=\"#activer-le-rate-limiting\" aria-label=\"activer le rate limiting permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Activer le <a href=\"https://getkong.org/plugins/rate-limiting/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">rate-limiting</a></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl -X POST  http://localhost:8001/apis/GOT/plugins \\\n  --data &quot;name=rate-limiting&quot; \\\n  --data &quot;config.hour=2&quot;</code></pre></div>\n<p>Notre API est à présent limitée à 2 appels par heure.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl -i -X GET http://localhost:8000/got/characters/583?apiKey=secret\ncurl -i -X GET http://localhost:8000/got/characters/583?apiKey=secret\ncurl -i -X GET http://localhost:8000/got/characters/583?apiKey=secret</code></pre></div>\n<p>L’accès à notre API peut à présent se faire via notre API manager après seulement quelques minutes de configuration. Grâce à Kong, on pourra par la suite ajouter des contraintes d’accès, des règles de réécriture de requêtes ou encore du monitoring sans devoir modifier notre coeur métier, ou demander à nos partenaires de le faire.</p>\n<p>N’hésitez pas non plus à parcourir le site de Kong, et sa documentation plutôt complète pour voir tout ce qu’il pourrait faire pour vous.</p>\n<p><a href=\"https://getkong.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Site officiel - https://getkong.org/</a></p>\n<p>Par ailleurs, vous pourrez retrouver la configuration décrite précédemnt directement <a href=\"https://github.com/d3rwan/kong_docker_stack\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sur ce repo github</a></p>\n<p>Et devenez le <em>king</em> de vos API’s!</p>","fields":{"slug":"/posts/kong","tagSlugs":["/tag/api/","/tag/api-management/","/tag/docker/","/tag/architecture/"]},"frontmatter":{"date":"2017-02-11T12:00:00.000Z","description":"Mise en place d’une solution d’API Management dans votre infrastructure","tags":["API","API Management","Docker","Architecture"],"title":"Régnez sur vos APIs avec Kong","socialImage":"/d3rwan-blog/media/kong.jpg"}}},"pageContext":{"slug":"/posts/kong"}}}